{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\danie\\\\Documents\\\\computerscience\\\\BetterMeals\\\\bettermeal\\\\src\\\\components\\\\Auth\\\\RequireAuth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nimport * as React from \"react\";\nimport axios from \"axios\";\nimport { useLocation, Navigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authContext = /*#__PURE__*/React.createContext();\n\nfunction useAuth() {\n  _s();\n\n  const [auth, setAuth] = React.useState(false);\n  const [user, setUser] = React.useState(null);\n  const config = {\n    headers: {\n      \"x-access-token\": localStorage.getItem(\"token\")\n    }\n  };\n  axios.get('http://localhost:5000/user/isUserAuth', config).then(res => {\n    setAuth(res.data.isAuth);\n    setUser(res.data.user.username);\n  });\n  return {\n    auth,\n    user\n  };\n}\n\n_s(useAuth, \"rqDbSe6/I4DJmsYMvK9kheM1mJs=\");\n\nexport function RequireAuth({\n  children\n}) {\n  _s2();\n\n  const {\n    authorized\n  } = useAuth();\n  const location = useLocation();\n\n  if (authorized === false) {\n    history.push(location.state.path);\n    return;\n  }\n\n  return authorized === true ? children : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/mealplans\",\n    replace: true,\n    state: {\n      path: location.pathname\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 45\n  }, this);\n}\n\n_s2(RequireAuth, \"HFi+qh77f6RR8H44WgneKBneYH4=\", false, function () {\n  return [useAuth, useLocation];\n});\n\n_c = RequireAuth;\nexport function AuthProvider({\n  children\n}) {\n  _s3();\n\n  const {\n    auth,\n    user\n  } = useAuth();\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: {\n      auth,\n      user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 12\n  }, this);\n}\n\n_s3(AuthProvider, \"uuUw7tpbEWUeJkk0H3K5TK3yPp8=\", false, function () {\n  return [useAuth];\n});\n\n_c2 = AuthProvider;\nexport default function AuthConsumer() {\n  _s4();\n\n  React.useContext(authContext);\n}\n\n_s4(AuthConsumer, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\n_c3 = AuthConsumer;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"RequireAuth\");\n$RefreshReg$(_c2, \"AuthProvider\");\n$RefreshReg$(_c3, \"AuthConsumer\");","map":{"version":3,"sources":["C:/Users/danie/Documents/computerscience/BetterMeals/bettermeal/src/components/Auth/RequireAuth.js"],"names":["React","axios","useLocation","Navigate","authContext","createContext","useAuth","auth","setAuth","useState","user","setUser","config","headers","localStorage","getItem","get","then","res","data","isAuth","username","RequireAuth","children","authorized","location","history","push","state","path","pathname","AuthProvider","AuthConsumer","useContext"],"mappings":";;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,EAAsBC,QAAtB,QAAsC,kBAAtC;;AAEA,MAAMC,WAAW,gBAAGJ,KAAK,CAACK,aAAN,EAApB;;AAEA,SAASC,OAAT,GAAkB;AAAA;;AACd,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,KAAK,CAACS,QAAN,CAAe,KAAf,CAAxB;AACA,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBX,KAAK,CAACS,QAAN,CAAe,IAAf,CAAxB;AAEA,QAAMG,MAAM,GAAG;AACXC,IAAAA,OAAO,EAAC;AACR,wBAAkBC,YAAY,CAACC,OAAb,CAAqB,OAArB;AADV;AADG,GAAf;AAMAd,EAAAA,KAAK,CAACe,GAAN,CAAU,uCAAV,EAAmDJ,MAAnD,EACKK,IADL,CACUC,GAAG,IAAI;AACTV,IAAAA,OAAO,CAACU,GAAG,CAACC,IAAJ,CAASC,MAAV,CAAP;AACAT,IAAAA,OAAO,CAACO,GAAG,CAACC,IAAJ,CAAST,IAAT,CAAcW,QAAf,CAAP;AACH,GAJL;AAKA,SAAO;AAAEd,IAAAA,IAAF;AAAQG,IAAAA;AAAR,GAAP;AACH;;GAhBQJ,O;;AAkBT,OAAO,SAASgB,WAAT,CAAqB;AAAEC,EAAAA;AAAF,CAArB,EAAkC;AAAA;;AACrC,QAAM;AAAEC,IAAAA;AAAF,MAAiBlB,OAAO,EAA9B;AACA,QAAMmB,QAAQ,GAAGvB,WAAW,EAA5B;;AAEA,MAAGsB,UAAU,KAAK,KAAlB,EAAwB;AACpBE,IAAAA,OAAO,CAACC,IAAR,CAAaF,QAAQ,CAACG,KAAT,CAAeC,IAA5B;AACA;AACH;;AACD,SAAOL,UAAU,KAAK,IAAf,GAAsBD,QAAtB,gBAAiC,QAAC,QAAD;AAAU,IAAA,EAAE,EAAC,YAAb;AAA0B,IAAA,OAAO,MAAjC;AAAkC,IAAA,KAAK,EAAE;AAAEM,MAAAA,IAAI,EAAEJ,QAAQ,CAACK;AAAjB;AAAzC;AAAA;AAAA;AAAA;AAAA,UAAxC;AAEH;;IAVeR,W;UACWhB,O,EACNJ,W;;;KAFLoB,W;AAYhB,OAAO,SAASS,YAAT,CAAsB;AAAER,EAAAA;AAAF,CAAtB,EAAmC;AAAA;;AACtC,QAAM;AAAChB,IAAAA,IAAD;AAAOG,IAAAA;AAAP,MAAeJ,OAAO,EAA5B;AAEA,sBAAO,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAACC,MAAAA,IAAD;AAAOG,MAAAA;AAAP,KAA7B;AAAA,cAA4Ca;AAA5C;AAAA;AAAA;AAAA;AAAA,UAAP;AACH;;IAJeQ,Y;UACSzB,O;;;MADTyB,Y;AAOhB,eAAe,SAASC,YAAT,GAAuB;AAAA;;AAClChC,EAAAA,KAAK,CAACiC,UAAN,CAAiB7B,WAAjB;AACH;;IAFuB4B,Y;;MAAAA,Y","sourcesContent":["import * as React from \"react\";\r\nimport axios from \"axios\";\r\nimport { useLocation, Navigate } from 'react-router-dom'\r\n\r\nconst authContext = React.createContext();\r\n\r\nfunction useAuth(){\r\n    const [auth, setAuth] = React.useState(false);\r\n    const [user, setUser] = React.useState(null);\r\n\r\n    const config = {\r\n        headers:{\r\n        \"x-access-token\": localStorage.getItem(\"token\")\r\n        }\r\n    }\r\n    \r\n    axios.get('http://localhost:5000/user/isUserAuth', config)\r\n        .then(res => {\r\n            setAuth(res.data.isAuth);\r\n            setUser(res.data.user.username)\r\n        })\r\n    return { auth, user }\r\n}\r\n\r\nexport function RequireAuth({ children }){\r\n    const { authorized } = useAuth();\r\n    const location = useLocation();\r\n\r\n    if(authorized === false){\r\n        history.push(location.state.path)\r\n        return \r\n    }\r\n    return authorized === true ? children : <Navigate to=\"/mealplans\" replace state={{ path: location.pathname }} />\r\n\r\n}\r\n\r\nexport function AuthProvider({ children }){\r\n    const {auth, user} = useAuth()\r\n\r\n    return <authContext.Provider value={{auth, user}}>{children}</authContext.Provider>\r\n}\r\n\r\n\r\nexport default function AuthConsumer(){\r\n    React.useContext(authContext);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}